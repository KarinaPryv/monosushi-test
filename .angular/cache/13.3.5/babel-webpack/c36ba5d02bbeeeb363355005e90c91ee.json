{"ast":null,"code":"import _asyncToGenerator from \"/Users/karyna/Desktop/monosushi/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { Validators } from '@angular/forms';\nimport { deleteObject, getDownloadURL, percentage, ref, uploadBytesResumable } from '@angular/fire/storage';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"src/app/shared/services/products.service\";\nimport * as i3 from \"@angular/fire/storage\";\nimport * as i4 from \"@angular/common\";\n\nfunction AdminArticlesComponent_ng_container_2_tr_21_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\");\n    i0.ɵɵelement(10, \"img\", 4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"td\")(12, \"div\", 5)(13, \"button\", 6);\n    i0.ɵɵlistener(\"click\", function AdminArticlesComponent_ng_container_2_tr_21_Template_button_click_13_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r6);\n      const product_r3 = restoredCtx.$implicit;\n      const ctx_r5 = i0.ɵɵnextContext(2);\n      return ctx_r5.editProduct(product_r3);\n    });\n    i0.ɵɵtext(14, \"\\u0420\\u0435\\u0434\\u0430\\u0433\\u0443\\u0432\\u0430\\u0442\\u0438\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"button\", 6);\n    i0.ɵɵlistener(\"click\", function AdminArticlesComponent_ng_container_2_tr_21_Template_button_click_15_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r6);\n      const product_r3 = restoredCtx.$implicit;\n      const ctx_r7 = i0.ɵɵnextContext(2);\n      return ctx_r7.deleteProduct(product_r3.id);\n    });\n    i0.ɵɵtext(16, \"\\u0412\\u0438\\u0434\\u0430\\u043B\\u0438\\u0442\\u0438\");\n    i0.ɵɵelementEnd()()()();\n  }\n\n  if (rf & 2) {\n    const product_r3 = ctx.$implicit;\n    const i_r4 = ctx.index;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i_r4 + 1);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(product_r3.category);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(product_r3.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(product_r3.path);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"src\", product_r3.imagePath, i0.ɵɵsanitizeUrl);\n  }\n}\n\nfunction AdminArticlesComponent_ng_container_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"table\", 2)(2, \"thead\")(3, \"tr\")(4, \"th\");\n    i0.ɵɵtext(5, \"No\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"th\");\n    i0.ɵɵtext(7, \"\\u041A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0456\\u044F\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"th\");\n    i0.ɵɵtext(9, \"\\u041D\\u0430\\u0437\\u0432\\u0430\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"th\");\n    i0.ɵɵtext(11, \"\\u0406\\u043D\\u0433\\u0440\\u0456\\u0434\\u0456\\u0454\\u043D\\u0442\\u0438\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"th\");\n    i0.ɵɵtext(13, \"\\u0412\\u0430\\u0433\\u0430\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"th\");\n    i0.ɵɵtext(15, \"\\u0426\\u0456\\u043D\\u0430\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"th\");\n    i0.ɵɵtext(17, \"\\u041A\\u0430\\u0440\\u0442\\u0438\\u043D\\u043A\\u0430\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(18, \"th\");\n    i0.ɵɵtext(19, \"\\u0414\\u0456\\u0457\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(20, \"tbody\");\n    i0.ɵɵtemplate(21, AdminArticlesComponent_ng_container_2_tr_21_Template, 17, 5, \"tr\", 3);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(21);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.adminProducts);\n  }\n}\n\nfunction AdminArticlesComponent_ng_container_3_ng_container_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"input\", 12);\n    i0.ɵɵlistener(\"change\", function AdminArticlesComponent_ng_container_3_ng_container_5_Template_input_change_1_listener($event) {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r10 = i0.ɵɵnextContext(2);\n      return ctx_r10.upload($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(2, \"div\", 13);\n    i0.ɵɵelement(3, \"div\", 14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵstyleProp(\"width\", ctx_r8.uploadPercent, \"%\");\n  }\n}\n\nfunction AdminArticlesComponent_ng_container_3_ng_container_6_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelement(1, \"img\", 15);\n    i0.ɵɵelementStart(2, \"button\", 16);\n    i0.ɵɵlistener(\"click\", function AdminArticlesComponent_ng_container_3_ng_container_6_Template_button_click_2_listener() {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r12 = i0.ɵɵnextContext(2);\n      return ctx_r12.deleteImage();\n    });\n    i0.ɵɵtext(3, \"\\u0412\\u0418\\u0414\\u0410\\u041B\\u0418\\u0422\\u0418\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r9 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"src\", ctx_r9.valueByControl(\"imagePath\"), i0.ɵɵsanitizeUrl);\n  }\n}\n\nfunction AdminArticlesComponent_ng_container_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r15 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"form\", 7);\n    i0.ɵɵlistener(\"ngSubmit\", function AdminArticlesComponent_ng_container_3_Template_form_ngSubmit_1_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const ctx_r14 = i0.ɵɵnextContext();\n      return ctx_r14.saveProduct();\n    });\n    i0.ɵɵelementStart(2, \"div\", 8);\n    i0.ɵɵelement(3, \"input\", 9)(4, \"input\", 10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(5, AdminArticlesComponent_ng_container_3_ng_container_5_Template, 4, 2, \"ng-container\", 1);\n    i0.ɵɵtemplate(6, AdminArticlesComponent_ng_container_3_ng_container_6_Template, 4, 1, \"ng-container\", 1);\n    i0.ɵɵelementStart(7, \"button\", 11);\n    i0.ɵɵtext(8, \"\\u0417\\u0411\\u0415\\u0420\\u0415\\u0413\\u0422\\u0418\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"formGroup\", ctx_r1.productsForm);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r1.isUploaded);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.isUploaded);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"disabled\", ctx_r1.productsForm.invalid);\n  }\n}\n\nexport class AdminArticlesComponent {\n  constructor(fb, productsService, storage) {\n    this.fb = fb;\n    this.productsService = productsService;\n    this.storage = storage;\n    this.adminProducts = new Array();\n    this.isFormHidden = true;\n    this.editStatus = false;\n    this.isUploaded = false;\n  }\n\n  ngOnInit() {}\n\n  getProducts() {\n    this.productsService.getAll().subscribe(products => {\n      this.adminProducts = products;\n    });\n  }\n\n  initProductsForm() {\n    this.productsForm = this.fb.group({\n      name: [null, Validators.required],\n      title: [null, Validators.required],\n      description: [null, Validators.required],\n      imagePath: ['https://monosushi.com.ua/wp-content/uploads/2020/12/rol-tyzhnya-2-1-697x379.png', Validators.required]\n    });\n  }\n\n  addProduct() {\n    this.isFormHidden = false;\n  }\n\n  saveProduct() {\n    if (this.editStatus) {\n      this.productsService.update(this.productsForm.value, this.currentProductId).subscribe(() => {\n        this.getProducts();\n      });\n    } else {\n      this.productsService.create(this.productsForm.value).subscribe(() => {\n        this.getProducts();\n      });\n    }\n\n    this.editStatus = false;\n    this.productsForm.reset();\n    this.isUploaded = false;\n    this.uploadPercent = 0;\n    this.isFormHidden = true;\n  }\n\n  deleteProduct(discountId) {\n    this.productsService.delete(discountId).subscribe(() => {\n      this.getDiscounts();\n    });\n  }\n\n  editProduct(editedDiscount) {\n    this.productsForm.patchValue({\n      name: editedDiscount.name,\n      title: editedDiscount.title,\n      description: editedDiscount.description,\n      imagePath: editedDiscount.imagePath\n    });\n    this.editStatus = true;\n    this.currentProductId = editedDiscount.id;\n    this.isUploaded = true;\n    this.isFormHidden = false;\n  }\n\n  upload(event) {\n    const file = event.target.files[0];\n    this.uploadFile('images', file.name, file).then(data => {\n      this.productsForm.patchValue({\n        imagePath: data\n      });\n      this.isUploaded = true;\n    }).catch(err => {\n      console.log(err);\n    });\n  }\n\n  uploadFile(folder, name, file) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      const path = `${folder}/${name}`;\n      let url = '';\n\n      if (file) {\n        try {\n          const storageRef = ref(_this.storage, path);\n          const task = uploadBytesResumable(storageRef, file);\n          percentage(task).subscribe(data => {\n            _this.uploadPercent = data.progress;\n          });\n          yield task;\n          url = yield getDownloadURL(storageRef);\n        } catch (e) {\n          console.error(e);\n        }\n      } else {\n        console.log('wrong format');\n      }\n\n      return Promise.resolve(url);\n    })();\n  }\n\n  valueByControl(control) {\n    var _a;\n\n    return (_a = this.productsForm.get(control)) === null || _a === void 0 ? void 0 : _a.value;\n  }\n\n  deleteImage() {\n    const task = ref(this.storage, this.valueByControl('imagePath'));\n    deleteObject(task).then(() => {\n      this.isUploaded = false;\n      this.uploadPercent = 0;\n      this.productsForm.patchValue({\n        imagePath: null\n      });\n    });\n  }\n\n}\n\nAdminArticlesComponent.ɵfac = function AdminArticlesComponent_Factory(t) {\n  return new (t || AdminArticlesComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.ProductsService), i0.ɵɵdirectiveInject(i3.Storage));\n};\n\nAdminArticlesComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: AdminArticlesComponent,\n  selectors: [[\"app-admin-articles\"]],\n  decls: 4,\n  vars: 2,\n  consts: [[1, \"btn\", 3, \"click\"], [4, \"ngIf\"], [1, \"table\", \"categories-table\"], [4, \"ngFor\", \"ngForOf\"], [\"alt\", \"\", 1, \"category-img\", 3, \"src\"], [1, \"d-flex\", \"flex-column\"], [3, \"click\"], [1, \"d-flex\", \"flex-column\", 3, \"formGroup\", \"ngSubmit\"], [1, \"d-flex\", \"justify-content-between\"], [\"type\", \"text\", \"formControlName\", \"name\", \"placeholder\", \"*\\u041D\\u0430\\u0437\\u0432\\u0430\", 1, \"input\"], [\"type\", \"text\", \"formControlName\", \"path\", \"placeholder\", \"*\\u0428\\u043B\\u044F\\u0445\", 1, \"input\"], [\"type\", \"submit\", 1, \"btn\", 3, \"disabled\"], [\"type\", \"file\", 1, \"form-control\", \"form-control-lg\", \"file-input\", 3, \"change\"], [1, \"progress\", 2, \"height\", \"20px\"], [\"role\", \"progressbar\", \"aria-valuemin\", \"0\", \"aria-valuemax\", \"100\", 1, \"progress-bar\"], [\"alt\", \"\", 1, \"upload-image\", 3, \"src\"], [\"type\", \"button\", 1, \"btn-delete\", 3, \"click\"]],\n  template: function AdminArticlesComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"button\", 0);\n      i0.ɵɵlistener(\"click\", function AdminArticlesComponent_Template_button_click_0_listener() {\n        return ctx.addProduct();\n      });\n      i0.ɵɵtext(1, \"\\u0414\\u041E\\u0414\\u0410\\u0422\\u0418 \\u041F\\u0420\\u041E\\u0414\\u0423\\u041A\\u0422\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(2, AdminArticlesComponent_ng_container_2_Template, 22, 1, \"ng-container\", 1);\n      i0.ɵɵtemplate(3, AdminArticlesComponent_ng_container_3_Template, 9, 4, \"ng-container\", 1);\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.isFormHidden);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", !ctx.isFormHidden);\n    }\n  },\n  directives: [i4.NgIf, i4.NgForOf, i1.ɵNgNoValidate, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.DefaultValueAccessor, i1.NgControlStatus, i1.FormControlName],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJhZG1pbi1hcnRpY2xlcy5jb21wb25lbnQuc2NzcyJ9 */\"]\n});","map":{"version":3,"sources":["/Users/karyna/Desktop/monosushi/src/app/admin/admin-articles/admin-articles.component.ts"],"names":["Validators","deleteObject","getDownloadURL","percentage","ref","uploadBytesResumable","i0","i1","i2","i3","i4","AdminArticlesComponent_ng_container_2_tr_21_Template","rf","ctx","_r6","ɵɵgetCurrentView","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵelement","ɵɵlistener","AdminArticlesComponent_ng_container_2_tr_21_Template_button_click_13_listener","restoredCtx","ɵɵrestoreView","product_r3","$implicit","ctx_r5","ɵɵnextContext","editProduct","AdminArticlesComponent_ng_container_2_tr_21_Template_button_click_15_listener","ctx_r7","deleteProduct","id","i_r4","index","ɵɵadvance","ɵɵtextInterpolate","category","name","path","ɵɵproperty","imagePath","ɵɵsanitizeUrl","AdminArticlesComponent_ng_container_2_Template","ɵɵelementContainerStart","ɵɵtemplate","ɵɵelementContainerEnd","ctx_r0","adminProducts","AdminArticlesComponent_ng_container_3_ng_container_5_Template","_r11","AdminArticlesComponent_ng_container_3_ng_container_5_Template_input_change_1_listener","$event","ctx_r10","upload","ctx_r8","ɵɵstyleProp","uploadPercent","AdminArticlesComponent_ng_container_3_ng_container_6_Template","_r13","AdminArticlesComponent_ng_container_3_ng_container_6_Template_button_click_2_listener","ctx_r12","deleteImage","ctx_r9","valueByControl","AdminArticlesComponent_ng_container_3_Template","_r15","AdminArticlesComponent_ng_container_3_Template_form_ngSubmit_1_listener","ctx_r14","saveProduct","ctx_r1","productsForm","isUploaded","invalid","AdminArticlesComponent","constructor","fb","productsService","storage","Array","isFormHidden","editStatus","ngOnInit","getProducts","getAll","subscribe","products","initProductsForm","group","required","title","description","addProduct","update","value","currentProductId","create","reset","discountId","delete","getDiscounts","editedDiscount","patchValue","event","file","target","files","uploadFile","then","data","catch","err","console","log","folder","url","storageRef","task","progress","e","error","Promise","resolve","control","_a","get","ɵfac","AdminArticlesComponent_Factory","t","ɵɵdirectiveInject","FormBuilder","ProductsService","Storage","ɵcmp","ɵɵdefineComponent","type","selectors","decls","vars","consts","template","AdminArticlesComponent_Template","AdminArticlesComponent_Template_button_click_0_listener","directives","NgIf","NgForOf","ɵNgNoValidate","NgControlStatusGroup","FormGroupDirective","DefaultValueAccessor","NgControlStatus","FormControlName","styles"],"mappings":"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","sourcesContent":["import { Validators } from '@angular/forms';\nimport { deleteObject, getDownloadURL, percentage, ref, uploadBytesResumable } from '@angular/fire/storage';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"src/app/shared/services/products.service\";\nimport * as i3 from \"@angular/fire/storage\";\nimport * as i4 from \"@angular/common\";\nfunction AdminArticlesComponent_ng_container_2_tr_21_Template(rf, ctx) { if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\");\n    i0.ɵɵelement(10, \"img\", 4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"td\")(12, \"div\", 5)(13, \"button\", 6);\n    i0.ɵɵlistener(\"click\", function AdminArticlesComponent_ng_container_2_tr_21_Template_button_click_13_listener() { const restoredCtx = i0.ɵɵrestoreView(_r6); const product_r3 = restoredCtx.$implicit; const ctx_r5 = i0.ɵɵnextContext(2); return ctx_r5.editProduct(product_r3); });\n    i0.ɵɵtext(14, \"\\u0420\\u0435\\u0434\\u0430\\u0433\\u0443\\u0432\\u0430\\u0442\\u0438\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"button\", 6);\n    i0.ɵɵlistener(\"click\", function AdminArticlesComponent_ng_container_2_tr_21_Template_button_click_15_listener() { const restoredCtx = i0.ɵɵrestoreView(_r6); const product_r3 = restoredCtx.$implicit; const ctx_r7 = i0.ɵɵnextContext(2); return ctx_r7.deleteProduct(product_r3.id); });\n    i0.ɵɵtext(16, \"\\u0412\\u0438\\u0434\\u0430\\u043B\\u0438\\u0442\\u0438\");\n    i0.ɵɵelementEnd()()()();\n} if (rf & 2) {\n    const product_r3 = ctx.$implicit;\n    const i_r4 = ctx.index;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i_r4 + 1);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(product_r3.category);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(product_r3.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(product_r3.path);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"src\", product_r3.imagePath, i0.ɵɵsanitizeUrl);\n} }\nfunction AdminArticlesComponent_ng_container_2_Template(rf, ctx) { if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"table\", 2)(2, \"thead\")(3, \"tr\")(4, \"th\");\n    i0.ɵɵtext(5, \"No\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"th\");\n    i0.ɵɵtext(7, \"\\u041A\\u0430\\u0442\\u0435\\u0433\\u043E\\u0440\\u0456\\u044F\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"th\");\n    i0.ɵɵtext(9, \"\\u041D\\u0430\\u0437\\u0432\\u0430\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"th\");\n    i0.ɵɵtext(11, \"\\u0406\\u043D\\u0433\\u0440\\u0456\\u0434\\u0456\\u0454\\u043D\\u0442\\u0438\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"th\");\n    i0.ɵɵtext(13, \"\\u0412\\u0430\\u0433\\u0430\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"th\");\n    i0.ɵɵtext(15, \"\\u0426\\u0456\\u043D\\u0430\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"th\");\n    i0.ɵɵtext(17, \"\\u041A\\u0430\\u0440\\u0442\\u0438\\u043D\\u043A\\u0430\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(18, \"th\");\n    i0.ɵɵtext(19, \"\\u0414\\u0456\\u0457\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(20, \"tbody\");\n    i0.ɵɵtemplate(21, AdminArticlesComponent_ng_container_2_tr_21_Template, 17, 5, \"tr\", 3);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementContainerEnd();\n} if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(21);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.adminProducts);\n} }\nfunction AdminArticlesComponent_ng_container_3_ng_container_5_Template(rf, ctx) { if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"input\", 12);\n    i0.ɵɵlistener(\"change\", function AdminArticlesComponent_ng_container_3_ng_container_5_Template_input_change_1_listener($event) { i0.ɵɵrestoreView(_r11); const ctx_r10 = i0.ɵɵnextContext(2); return ctx_r10.upload($event); });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(2, \"div\", 13);\n    i0.ɵɵelement(3, \"div\", 14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n} if (rf & 2) {\n    const ctx_r8 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵstyleProp(\"width\", ctx_r8.uploadPercent, \"%\");\n} }\nfunction AdminArticlesComponent_ng_container_3_ng_container_6_Template(rf, ctx) { if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelement(1, \"img\", 15);\n    i0.ɵɵelementStart(2, \"button\", 16);\n    i0.ɵɵlistener(\"click\", function AdminArticlesComponent_ng_container_3_ng_container_6_Template_button_click_2_listener() { i0.ɵɵrestoreView(_r13); const ctx_r12 = i0.ɵɵnextContext(2); return ctx_r12.deleteImage(); });\n    i0.ɵɵtext(3, \"\\u0412\\u0418\\u0414\\u0410\\u041B\\u0418\\u0422\\u0418\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n} if (rf & 2) {\n    const ctx_r9 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"src\", ctx_r9.valueByControl(\"imagePath\"), i0.ɵɵsanitizeUrl);\n} }\nfunction AdminArticlesComponent_ng_container_3_Template(rf, ctx) { if (rf & 1) {\n    const _r15 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"form\", 7);\n    i0.ɵɵlistener(\"ngSubmit\", function AdminArticlesComponent_ng_container_3_Template_form_ngSubmit_1_listener() { i0.ɵɵrestoreView(_r15); const ctx_r14 = i0.ɵɵnextContext(); return ctx_r14.saveProduct(); });\n    i0.ɵɵelementStart(2, \"div\", 8);\n    i0.ɵɵelement(3, \"input\", 9)(4, \"input\", 10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(5, AdminArticlesComponent_ng_container_3_ng_container_5_Template, 4, 2, \"ng-container\", 1);\n    i0.ɵɵtemplate(6, AdminArticlesComponent_ng_container_3_ng_container_6_Template, 4, 1, \"ng-container\", 1);\n    i0.ɵɵelementStart(7, \"button\", 11);\n    i0.ɵɵtext(8, \"\\u0417\\u0411\\u0415\\u0420\\u0415\\u0413\\u0422\\u0418\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementContainerEnd();\n} if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"formGroup\", ctx_r1.productsForm);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r1.isUploaded);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.isUploaded);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"disabled\", ctx_r1.productsForm.invalid);\n} }\nexport class AdminArticlesComponent {\n    constructor(fb, productsService, storage) {\n        this.fb = fb;\n        this.productsService = productsService;\n        this.storage = storage;\n        this.adminProducts = new Array();\n        this.isFormHidden = true;\n        this.editStatus = false;\n        this.isUploaded = false;\n    }\n    ngOnInit() {\n    }\n    getProducts() {\n        this.productsService.getAll().subscribe(products => {\n            this.adminProducts = products;\n        });\n    }\n    initProductsForm() {\n        this.productsForm = this.fb.group({\n            name: [null, Validators.required],\n            title: [null, Validators.required],\n            description: [null, Validators.required],\n            imagePath: ['https://monosushi.com.ua/wp-content/uploads/2020/12/rol-tyzhnya-2-1-697x379.png', Validators.required]\n        });\n    }\n    addProduct() {\n        this.isFormHidden = false;\n    }\n    saveProduct() {\n        if (this.editStatus) {\n            this.productsService.update(this.productsForm.value, this.currentProductId).subscribe(() => {\n                this.getProducts();\n            });\n        }\n        else {\n            this.productsService.create(this.productsForm.value).subscribe(() => {\n                this.getProducts();\n            });\n        }\n        this.editStatus = false;\n        this.productsForm.reset();\n        this.isUploaded = false;\n        this.uploadPercent = 0;\n        this.isFormHidden = true;\n    }\n    deleteProduct(discountId) {\n        this.productsService.delete(discountId).subscribe(() => {\n            this.getDiscounts();\n        });\n    }\n    editProduct(editedDiscount) {\n        this.productsForm.patchValue({\n            name: editedDiscount.name,\n            title: editedDiscount.title,\n            description: editedDiscount.description,\n            imagePath: editedDiscount.imagePath,\n        });\n        this.editStatus = true;\n        this.currentProductId = editedDiscount.id;\n        this.isUploaded = true;\n        this.isFormHidden = false;\n    }\n    upload(event) {\n        const file = event.target.files[0];\n        this.uploadFile('images', file.name, file)\n            .then(data => {\n            this.productsForm.patchValue({\n                imagePath: data\n            });\n            this.isUploaded = true;\n        })\n            .catch(err => {\n            console.log(err);\n        });\n    }\n    async uploadFile(folder, name, file) {\n        const path = `${folder}/${name}`;\n        let url = '';\n        if (file) {\n            try {\n                const storageRef = ref(this.storage, path);\n                const task = uploadBytesResumable(storageRef, file);\n                percentage(task).subscribe(data => {\n                    this.uploadPercent = data.progress;\n                });\n                await task;\n                url = await getDownloadURL(storageRef);\n            }\n            catch (e) {\n                console.error(e);\n            }\n        }\n        else {\n            console.log('wrong format');\n        }\n        return Promise.resolve(url);\n    }\n    valueByControl(control) {\n        var _a;\n        return (_a = this.productsForm.get(control)) === null || _a === void 0 ? void 0 : _a.value;\n    }\n    deleteImage() {\n        const task = ref(this.storage, this.valueByControl('imagePath'));\n        deleteObject(task).then(() => {\n            this.isUploaded = false;\n            this.uploadPercent = 0;\n            this.productsForm.patchValue({\n                imagePath: null\n            });\n        });\n    }\n}\nAdminArticlesComponent.ɵfac = function AdminArticlesComponent_Factory(t) { return new (t || AdminArticlesComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.ProductsService), i0.ɵɵdirectiveInject(i3.Storage)); };\nAdminArticlesComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: AdminArticlesComponent, selectors: [[\"app-admin-articles\"]], decls: 4, vars: 2, consts: [[1, \"btn\", 3, \"click\"], [4, \"ngIf\"], [1, \"table\", \"categories-table\"], [4, \"ngFor\", \"ngForOf\"], [\"alt\", \"\", 1, \"category-img\", 3, \"src\"], [1, \"d-flex\", \"flex-column\"], [3, \"click\"], [1, \"d-flex\", \"flex-column\", 3, \"formGroup\", \"ngSubmit\"], [1, \"d-flex\", \"justify-content-between\"], [\"type\", \"text\", \"formControlName\", \"name\", \"placeholder\", \"*\\u041D\\u0430\\u0437\\u0432\\u0430\", 1, \"input\"], [\"type\", \"text\", \"formControlName\", \"path\", \"placeholder\", \"*\\u0428\\u043B\\u044F\\u0445\", 1, \"input\"], [\"type\", \"submit\", 1, \"btn\", 3, \"disabled\"], [\"type\", \"file\", 1, \"form-control\", \"form-control-lg\", \"file-input\", 3, \"change\"], [1, \"progress\", 2, \"height\", \"20px\"], [\"role\", \"progressbar\", \"aria-valuemin\", \"0\", \"aria-valuemax\", \"100\", 1, \"progress-bar\"], [\"alt\", \"\", 1, \"upload-image\", 3, \"src\"], [\"type\", \"button\", 1, \"btn-delete\", 3, \"click\"]], template: function AdminArticlesComponent_Template(rf, ctx) { if (rf & 1) {\n        i0.ɵɵelementStart(0, \"button\", 0);\n        i0.ɵɵlistener(\"click\", function AdminArticlesComponent_Template_button_click_0_listener() { return ctx.addProduct(); });\n        i0.ɵɵtext(1, \"\\u0414\\u041E\\u0414\\u0410\\u0422\\u0418 \\u041F\\u0420\\u041E\\u0414\\u0423\\u041A\\u0422\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(2, AdminArticlesComponent_ng_container_2_Template, 22, 1, \"ng-container\", 1);\n        i0.ɵɵtemplate(3, AdminArticlesComponent_ng_container_3_Template, 9, 4, \"ng-container\", 1);\n    } if (rf & 2) {\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.isFormHidden);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.isFormHidden);\n    } }, directives: [i4.NgIf, i4.NgForOf, i1.ɵNgNoValidate, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.DefaultValueAccessor, i1.NgControlStatus, i1.FormControlName], styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJhZG1pbi1hcnRpY2xlcy5jb21wb25lbnQuc2NzcyJ9 */\"] });\n"]},"metadata":{},"sourceType":"module"}